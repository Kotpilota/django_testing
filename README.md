# Django Testing

[![Python](https://img.shields.io/badge/python-3.9+-blue)](https://www.python.org/)
[![Django](https://img.shields.io/badge/django-3.2.15-green)](https://www.djangoproject.com/)
[![Tests](https://img.shields.io/badge/tests-pytest%20%7C%20unittest-orange)](https://pytest.org/)

**Django Testing** — учебный проект, демонстрирующий практические навыки тестирования Django-приложений с использованием двух основных подходов: pytest и unittest. Проект включает в себя полноценные тестовые наборы для двух веб-приложений с различной функциональностью.

## О проекте

Этот репозиторий создан в рамках финального задания спринта по тестированию из курса "Python-разработчик" от Яндекс.Практикум. Основная цель — продемонстрировать владение различными методологиями тестирования Django-приложений.

### Цели проекта
- **Практическое применение** методов тестирования веб-приложений
- **Сравнение подходов** pytest vs unittest в контексте Django
- **Демонстрация навыков** написания качественных и надежных тестов
- **Покрытие основных сценариев** работы пользователей с приложениями

## Структура проекта

```
django_testing/
├── ya_news/                    # Новостной сайт (тесты на pytest)
│   ├── news/
│   │   ├── pytest_tests/       # Тесты pytest
│   │   │   ├── conftest.py     # Конфигурация фикстур
│   │   │   ├── test_content.py # Тесты контента страниц
│   │   │   ├── test_logic.py   # Тесты бизнес-логики
│   │   │   └── test_routers.py # Тесты маршрутизации
│   │   ├── models.py           # Модели News, Comment
│   │   ├── forms.py            # Формы с валидацией
│   │   └── views.py            # Представления
│   ├── templates/              # HTML шаблоны
│   ├── manage.py
│   └── pytest.ini             # Конфигурация pytest
│
├── ya_note/                    # Сервис заметок (тесты на unittest)
│   ├── notes/
│   │   ├── tests/              # Тесты unittest
│   │   │   ├── test_content.py # Тесты контента страниц
│   │   │   ├── test_logic.py   # Тесты бизнес-логики  
│   │   │   └── test_routers.py # Тесты маршрутизации
│   │   ├── models.py           # Модель Note
│   │   ├── forms.py            # Формы с автогенерацией slug
│   │   └── views.py            # CBV представления
│   ├── templates/              # HTML шаблоны
│   ├── manage.py
│   └── pytest.ini             # Конфигурация pytest
│
├── requirements.txt            # Зависимости проекта
├── run_tests.sh               # Скрипт автоматического запуска тестов
├── structure_test.py          # Проверка структуры проекта
├── setup.cfg                  # Конфигурация flake8
└── README.md                  # Документация
```

## Описание приложений

### YaNews - Новостной портал
Веб-приложение для публикации новостей с системой комментариев:

**Основной функционал:**
- Просмотр списка новостей (пагинация - 10 новостей на странице)
- Детальный просмотр отдельных новостей
- Система комментариев с аутентификацией
- Модерация комментариев (фильтрация нецензурных слов)
- Управление комментариями (редактирование/удаление автором)

**Особенности тестирования:**
- **Фреймворк:** pytest + pytest-django
- **Фикстуры:** Настроенные через conftest.py для создания тестовых данных
- **Покрытие:** Тесты маршрутов, контента, бизнес-логики

### YaNote - Персональные заметки  
Сервис для создания и управления личными заметками:

**Основной функционал:**
- CRUD операции с заметками (создание, чтение, обновление, удаление)
- Автоматическая генерация slug на основе заголовка
- Приватность заметок (каждый пользователь видит только свои)
- Система аутентификации и авторизации

**Особенности тестирования:**
- **Фреймворк:** unittest (стандартный Django TestCase)
- **Методология:** Классический подход с setUp методами  
- **Покрытие:** Полное тестирование доступов, форм и бизнес-логики

## Технологический стек

### Backend
- **Python 3.9+** - основной язык разработки
- **Django 3.2.15** - веб-фреймворк
- **SQLite** - база данных для разработки

### Тестирование  
- **pytest 7.1.3** - современный фреймворк тестирования
- **pytest-django 4.5.2** - интеграция pytest с Django
- **unittest** - встроенный модуль тестирования Python
- **pytest-lazy-fixture 0.6.3** - ленивые фикстуры

### Качество кода
- **flake8 5.0.4** - линтер для Python
- **pep8-naming 0.13.3** - проверка именования
- **flake8-docstrings 1.7.0** - проверка документации

### Дополнительные библиотеки
- **pytils 0.4.1** - транслитерация для slug

## Быстрый старт

### Требования
- Python 3.9 или выше
- pip (менеджер пакетов Python)

### Установка и запуск

1. **Клонируйте репозиторий:**
```bash
git clone https://github.com/yourusername/django_testing.git
cd django_testing
```

2. **Создайте виртуальное окружение:**
```bash
python -m venv venv

# Для Windows:
venv\Scripts\activate

# Для Linux/Mac:
source venv/bin/activate
```

3. **Установите зависимости:**
```bash
pip install -r requirements.txt
```

4. **Запустите все тесты:**
```bash
# Автоматический запуск всех тестов
bash run_tests.sh

# Или запуск тестов по отдельности:

# Тесты YaNews (pytest)
cd ya_news
pytest

# Тесты YaNote (unittest) 
cd ../ya_note
python manage.py test
```

## Описание тестов

### YaNews (pytest)

#### test_routes.py
- Доступность главной страницы для анонимных пользователей
- Доступность страницы отдельной новости
- Ограничение доступа к редактированию/удалению комментариев
- Редиректы для неавторизованных пользователей
- Ошибки 404 при попытке редактировать чужие комментарии

#### test_content.py  
- Ограничение количества новостей на главной (максимум 10)
- Сортировка новостей по дате (от новых к старым)
- Хронологическая сортировка комментариев
- Доступность форм для авторизованных пользователей

#### test_logic.py
- Создание комментариев авторизованными пользователями
- Блокировка создания комментариев анонимами
- Фильтрация нецензурной лексики
- Редактирование и удаление комментариев автором
- Защита от редактирования чужих комментариев

### YaNote (unittest)

#### test_routes.py
- Доступность публичных страниц (главная, регистрация, вход)
- Защищенные страницы для авторизованных пользователей
- Доступ к заметкам только для их авторов
- Редиректы на страницу входа для анонимов

#### test_content.py
- Отображение заметок в списке только для их авторов
- Изоляция заметок между пользователями  
- Наличие форм на страницах создания/редактирования

#### test_logic.py
- Создание заметок авторизованными пользователями
- Блокировка создания заметок анонимами
- Уникальность slug и автогенерация
- Редактирование и удаление заметок автором
- Защита заметок от редактирования другими пользователями

## Покрытие тестами

### Функциональные области:
- **Аутентификация и авторизация** - 100%
- **CRUD операции** - 100%  
- **Валидация форм** - 100%
- **Доступы и права пользователей** - 100%
- **Бизнес-логика приложений** - 100%

### Типы тестов:
- **Unit тесты** - тестирование отдельных компонентов
- **Integration тесты** - тестирование взаимодействий между компонентами
- **Functional тесты** - тестирование пользовательских сценариев

## Команды для разработчиков

```bash
# Проверка качества кода
flake8 --config=setup.cfg

# Запуск тестов с подробным выводом
pytest -v  # для ya_news
python manage.py test -v 2  # для ya_note

# Проверка структуры проекта
python structure_test.py

# Комплексная проверка (линтинг + тесты)
bash run_tests.sh
```

## Конфигурация тестов

### pytest (YaNews)
```ini
[pytest]
DJANGO_SETTINGS_MODULE = yanews.settings
norecursedirs = env/* venv/*
addopts = -vv -p no:cacheprovider
testpaths = news/pytest_tests/
python_files = test_*.py
```

### flake8
```ini
[flake8]
max-line-lenght = 79
max-complexity = 10
ignore = W503, F811, D100-D107, D203-D205, D213, D400-D401, N806, N818
exclude = */migrations/, venv/, env/
```

## Результаты проекта

**Полное покрытие тестами** всех ключевых функций двух приложений  
**Демонстрация владения** двумя подходами к тестированию Django  
**Автоматизированная проверка** качества кода через flake8  
**Готовая инфраструктура** для continuous integration  
**Документированный код** с понятной структурой проекта  
